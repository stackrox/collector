{
  // This configures Konflux Renovate bot a.k.a. MintMaker, the thing that keeps our pipelines use up-to-date tasks.

  // After making changes to this file, you can validate it by running something like this in the root of the repo:
  // $ docker run --rm -it --entrypoint=renovate-config-validator -v "$(pwd)":/mnt -w /mnt renovate/renovate --strict
  // Note: ignore errors about the config for `rpm-lockfile`. This is to be addressed with https://issues.redhat.com/browse/CWFHEALTH-4117
  // There are more validation options, see https://docs.renovatebot.com/config-validation/

  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    // Note that the base Konflux's MintMaker config gets inherited/included automatically per
    // https://redhat-internal.slack.com/archives/C04PZ7H0VA8/p1745492139282819?thread_ts=1745309786.090319&cid=C04PZ7H0VA8
    // The config is: https://github.com/konflux-ci/mintmaker/blob/main/config/renovate/renovate.json
    // We found out about it here (we may want to check that location if the base config gets suddenly moved):
    // https://github.com/enterprise-contract/ec-cli/blob/407847910ad420850385eea1db78e2a2e49c7e25/renovate.json#L1C1-L7C2

    // This tells Renovate to combine all updates in one PR so that we have fewer PRs to deal with.
    "group:all",
  ],
  // The number of PRs that can be open against the repo.
  "prConcurrentLimit": 20,
  // `null` means the branch limit should be the same as PR limit.
  "branchConcurrentLimit": null,
  // The number of PRs MintMaker can open in one hour, effectively in one run.
  "prHourlyLimit": 4,
  // Automerge all rpm-lockfile security updates. This is configured separately from other package managers.
  // https://konflux-ci.dev/docs/mintmaker/rpm-lockfile/#how-to-enable-automerge-for-rpm-security-updates
  "rpmVulnerabilityAutomerge": "ALL",
  "timezone": "Etc/UTC",
  "schedule": [
    // Allowed syntax: https://docs.renovatebot.com/configuration-options/#schedule
    // This is a "general" schedule for managers that don't declare their own.
    // The time was selected (with the help of https://time.fyi/timezones) so that Renovate isn't active during business
    // hours from Central Europe to US West Coast. This way, after we merge a PR, a new one does not pop up immediately
    // after that.
    // Between 3a.m. and 7a.m. every day.
    "* 3-7 * * *",
  ],
  // Tell Renovate not to update PRs when outside schedule.
  "updateNotScheduled": false,
  "tekton": {
    "schedule": [
      // Between 3a.m. and 7a.m. every day.
      // We duplicate our desired schedule here because Konflux global config tends to have a special override for it.
      "* 3-7 * * *",
    ],
    "packageRules": [
      // Note: the packageRules from the Konflux config (find URL in comments above) get merged with these.
      {
        "groupName": "StackRox custom Konflux Tasks",
        "matchPackageNames": [
          "/^quay.io/rhacs-eng/konflux-tasks/",
        ],
      },
    ],
  },
  "dockerfile": {
    "includePaths": [
      // Instruct Renovate not try to update Dockerfiles other than konflux.Dockerfile (or konflux.anything.Dockerfile)
      // to have less PR noise.
      "**/*konflux*.Dockerfile",
    ],
  },
  "enabledManagers": [
    // Restrict Renovate focus on Konflux things since we rely on GitHub's dependabot for everything else.
    "tekton",
    "dockerfile",
    "rpm-lockfile",
  ],
  "packageRules": [
    {
      "matchPackageNames": [
        "*",
      ],
      "groupName": "All updates",
      "automerge": true,
      // A known issue is that some non-Konflux CI jobs currently fail, which may prevent successful auto-merging with a "branch" auto-merge setting.
      // Therefore, we use PR merge type and have automation approve PRs.
      "automergeType": "pr",
      "automergeStrategy": "squash",
      // Tell Renovate that it can automerge branches at any time of the day.
      "automergeSchedule": [
        "at any time",
      ],
    }
  ],
  "labels": [
    // Add auto-approve label which triggers the corresponding workflow.
    "auto-approve",
    "build-builder-image",
    "rebuild-test-container",
  ],
}
